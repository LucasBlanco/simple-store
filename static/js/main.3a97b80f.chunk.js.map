{"version":3,"sources":["../../src/index.tsx","TodoService.tsx","Child.tsx","OtherChild.tsx","App.tsx","index.tsx"],"names":["SimpleStoreContext","createContext","useState","props","store","setStore","update","cb","newState","produce","value","useMemo","React","useTodos","context","useContext","Error","useSimpleStore","todos","toggleTodo","todo","foundTodo","find","x","id","checked","Child","useEffect","console","log","style","width","padding","borderRadius","boxShadow","map","key","type","onChange","name","OtherChild","App","initialValue","display","justifyContent","alignItems","height","ReactDOM","render","document","getElementById"],"mappings":"4MAYMA,EAAqBC,6BAA3B,G,MAWA,Y,MAC4BC,mBAAYC,EAAJ,cAA3BC,OAAOC,OAERC,EAAuB,SAACC,GAC5B,IAAMC,EAAWC,YAAO,GAAW,YACjCF,QAEFF,MAGIK,EAAQC,mBAAQ,iBAAM,CAACP,EAAP,KAAuB,CAA7C,IAEA,OAAOQ,kBAACZ,EAADY,wBAA6BF,MAAOA,GAA3C,K,OChCWG,EAAW,WAAO,IAAD,E,WDoC5B,IAAMC,EAAUC,qBAAhB,GACA,MACE,MAAM,IAAIC,MAAV,wJAIF,SCzC4BC,GADA,mBACnBC,EADmB,KACnBA,MAASZ,EADU,KAS5B,MAAO,CACLY,QACAC,WARiB,SAACC,GAClBd,GAAO,YAAgB,IACfe,EADc,EAAZH,MACgBI,MAAK,SAACC,GAAD,OAAOA,EAAEC,KAAOJ,EAAKI,MAClDH,EAAUI,SAAWJ,EAAUI,cCyBtBC,EA/BD,WAAO,IAAD,EACYb,IAAtBK,EADU,EACVA,MAAOC,EADG,EACHA,WAKf,OAHAQ,qBAAU,WACRC,QAAQC,IAAI,QAASX,KACpB,CAACA,IAEF,yBACEY,MAAO,CACLC,MAAO,IACPC,QAAS,GACTC,aAAc,GACdC,UAAW,kBAGb,qDACA,uDACChB,EAAMiB,KAAI,SAACf,GAAD,OACT,yBAAKgB,IAAKhB,EAAKI,IACb,2BACEa,KAAK,WACLZ,QAASL,EAAKK,QACda,SAAU,kBAAMnB,EAAWC,MAE7B,8BAAOA,EAAKmB,YCOPC,EA/BI,WAAO,IAAD,EACO3B,IAAtBK,EADe,EACfA,MAAOC,EADQ,EACRA,WAKf,OAHAQ,qBAAU,WACRC,QAAQC,IAAI,cAAeX,KAC1B,CAACA,IAEF,yBACEY,MAAO,CACLC,MAAO,IACPC,QAAS,GACTC,aAAc,GACdC,UAAW,kBAGb,2DACA,uDACChB,EAAMiB,KAAI,SAACf,GAAD,OACT,yBAAKgB,IAAKhB,EAAKI,IACb,2BACEa,KAAK,WACLZ,QAASL,EAAKK,QACda,SAAU,kBAAMnB,EAAWC,MAE7B,8BAAOA,EAAKmB,YCXhBrB,EAAQ,CACZ,CAAEM,GAAI,EAAGe,KAAM,uBAAwBd,SAAS,GAChD,CAAED,GAAI,EAAGe,KAAM,UAAWd,SAAS,IAoBtBgB,EAlBH,WACV,OACE,kBAAC,EAAD,CAAqBC,aAAc,CAAExB,UACnC,yBACEY,MAAO,CACLa,QAAS,OACTC,eAAgB,eAChBC,WAAY,SACZC,OAAQ,UAGV,kBAAC,EAAD,MACA,kBAAC,EAAD,SC1BRC,IAASC,OAAO,kBAAC,EAAD,MAASC,SAASC,eAAe,U","file":"static/js/main.3a97b80f.chunk.js","sourcesContent":["/* eslint-disable no-unused-vars */\nimport produce, { Draft } from 'immer'\nimport React, {\n  createContext,\n  PropsWithChildren,\n  useContext,\n  useMemo,\n  useState\n} from 'react'\n\ntype SimpleStoreInterface<T> = [T, UpdaterFn<T>]\n\nconst SimpleStoreContext = createContext<SimpleStoreInterface<unknown>>(\n  undefined!\n)\n\ntype CallbackFn<T> = (state: Draft<T>) => void\ntype UpdaterFn<T> = (cb: CallbackFn<T>) => void\n\ninterface Props<T> extends PropsWithChildren<any> {\n  initialValue: T\n}\n\nfunction SimpleStoreProvider<T extends Object>(props: Props<T>) {\n  const [store, setStore] = useState<T>(props.initialValue)\n\n  const update: UpdaterFn<T> = (cb) => {\n    const newState = produce<T>(store, (draft) => {\n      cb(draft)\n    })\n    setStore(newState)\n  }\n\n  const value = useMemo(() => [store, update], [store]) as [T, UpdaterFn<T>]\n\n  return <SimpleStoreContext.Provider value={value} {...props} />\n}\n\nexport function useSimpleStore<T>() {\n  const context = useContext(SimpleStoreContext)\n  if (!context) {\n    throw new Error(\n      `useSimpleStore must be used inside a SimpleStoreProvider. You should wrap all the components that uses the store inside a single SimpleStoreProvider`\n    )\n  }\n  return context as SimpleStoreInterface<T>\n}\n\nexport default SimpleStoreProvider\n","import { useSimpleStore } from '@lblanco/simple-store'\nimport { Store, Todo } from './App'\n\nexport const useTodos = () => {\n  const [{ todos }, update] = useSimpleStore<Store>()\n\n  const toggleTodo = (todo: Todo) => {\n    update(({ todos }) => {\n      const foundTodo = todos.find((x) => x.id === todo.id)!\n      foundTodo.checked = !foundTodo.checked\n    })\n  }\n  return {\n    todos,\n    toggleTodo\n  }\n}\n","import React, { useEffect } from 'react'\nimport { useTodos } from './TodoService'\n\nconst Child = () => {\n  const { todos, toggleTodo } = useTodos()\n\n  useEffect(() => {\n    console.log('child', todos)\n  }, [todos])\n  return (\n    <div\n      style={{\n        width: 300,\n        padding: 30,\n        borderRadius: 10,\n        boxShadow: '0 0 10px grey'\n      }}\n    >\n      <h3>I'm a Child component</h3>\n      <h5>We share the same store</h5>\n      {todos.map((todo) => (\n        <div key={todo.id}>\n          <input\n            type='checkbox'\n            checked={todo.checked}\n            onChange={() => toggleTodo(todo)}\n          />\n          <span>{todo.name}</span>\n        </div>\n      ))}\n    </div>\n  )\n}\n\nexport default Child\n","import React, { useEffect } from 'react'\nimport { useTodos } from './TodoService'\n\nconst OtherChild = () => {\n  const { todos, toggleTodo } = useTodos()\n\n  useEffect(() => {\n    console.log('other child', todos)\n  }, [todos])\n  return (\n    <div\n      style={{\n        width: 300,\n        padding: 30,\n        borderRadius: 10,\n        boxShadow: '0 0 10px grey'\n      }}\n    >\n      <h3>I'm another Child component</h3>\n      <h5>We share the same store</h5>\n      {todos.map((todo) => (\n        <div key={todo.id}>\n          <input\n            type='checkbox'\n            checked={todo.checked}\n            onChange={() => toggleTodo(todo)}\n          />\n          <span>{todo.name}</span>\n        </div>\n      ))}\n    </div>\n  )\n}\n\nexport default OtherChild\n","import React from 'react'\n\nimport SimpleStoreProvider from '@lblanco/simple-store'\nimport Child from './Child'\nimport OtherChild from './OtherChild'\n\nexport interface Todo {\n  id: number\n  name: string\n  checked: boolean\n}\n\nexport interface Store {\n  todos: Todo[]\n}\n\nconst todos = [\n  { id: 1, name: 'Install simple-store', checked: false },\n  { id: 2, name: 'Profit!', checked: false }\n]\nconst App = () => {\n  return (\n    <SimpleStoreProvider initialValue={{ todos }}>\n      <div\n        style={{\n          display: 'flex',\n          justifyContent: 'space-evenly',\n          alignItems: 'center',\n          height: '100vh'\n        }}\n      >\n        <Child />\n        <OtherChild />\n      </div>\n    </SimpleStoreProvider>\n  )\n}\n\nexport default App\n","import './index.css'\n\nimport React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './App'\n\nReactDOM.render(<App />, document.getElementById('root'))\n"],"sourceRoot":""}